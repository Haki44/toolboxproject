import os
import fnmatch

# Fonction pour rechercher des fichiers sensibles
def search_sensitive_files(base_dir):
    sensitive_files = []
    patterns = ['*.key', '*.pem', '*.env', '*.db', 'config*', 'password*', 'secret*']

    # Parcourir le système de fichiers
    for root, dirs, files in os.walk(base_dir):
        for pattern in patterns:
            for filename in fnmatch.filter(files, pattern):
                filepath = os.path.join(root, filename)
                sensitive_files.append(filepath)

    return sensitive_files

# Exemple d'utilisation
if __name__ == "__main__":
    base_directory = '/'  # Dossier racine pour l'exploration complète du système
    print("Recherche de fichiers sensibles...")
    found_files = search_sensitive_files(base_directory)

    if found_files:
        print("Fichiers sensibles trouvés :")
        for file in found_files:
            print(file)
    else:
        print("Aucun fichier sensible trouvé.")
